<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"class_DomResize.js.html":{"id":"class_DomResize.js.html","title":"Source: class/DomResize.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: class/DomResize.js import Events from './Event' /** * @description 节点大小监测。 * @example * // 使用 * let event = new DomResize(document.querySelector('#contianer')) * event.on('dom-resize', callback) */ class DomResize extends Events { width = 20000 oldWidth = 0 newWidth = 0 oldHeight = 0 newHeight = 0 supportsPassive = false constructor(el) { super() this.el = el this._init() } _init() { this.oldWidth = parseFloat(window.getComputedStyle(this.el).width) this.oldHeight = parseFloat(window.getComputedStyle(this.el).height) this.setSupportsPassive() this.createNode() } createNode() { // 监听变大的DOM const holderBig = document.createElement(\"div\") holderBig.style = \"position: absolute;top:0;left: 0;bottom: 0;right: 0;overflow: hidden;visibility: hidden;z-index:-1\" holderBig.innerHTML = `&lt;div style=\"width:${this.width}px;height:${this.width}px\"&gt;&lt;/div&gt;` // 监听变小的DOM const holderSmall = document.createElement(\"div\") holderSmall.style = \"position: absolute;top:0;left: 0;bottom: 0;right: 0;overflow: hidden;visibility: hidden;z-index:-1\" holderSmall.innerHTML = '&lt;div style=\"width:300%;height:300%\"&gt;&lt;/div&gt;' this.holderBig = holderBig this.holderSmall = holderSmall this.el.appendChild(holderBig) this.el.appendChild(holderSmall) holderSmall.scrollTop = this.width holderSmall.scrollLeft = this.width holderBig.scrollTop = this.width holderBig.scrollLeft = this.width holderBig.addEventListener( \"scroll\", this.scroll, this.supportsPassive ? { passive: true } : false, false ) holderSmall.addEventListener( \"scroll\", this.scroll, this.supportsPassive ? { passive: true } : false, false ) } scroll = () =&gt; { this.newWidth = parseFloat(window.getComputedStyle(this.el).width) this.newHeight = parseFloat(window.getComputedStyle(this.el).height) // 只有两次width不同时才分发事件，不然会多次分发 if (this.oldWidth !== this.newWidth || this.oldHeight !== this.newHeight) { this.emit(\"dom-resize\") this.oldWidth = this.newWidth this.oldHeight = this.newHeight } // 每次触发滚动事件后，重新将滚动条设至尽头 this.holderSmall.scrollTop = this.holderBig.scrollTop = this.width this.holderSmall.scrollLeft = this.holderBig.scrollLeft = this.width } setSupportsPassive() { try { const opts = Object.defineProperty({}, \"passive\", { get: () =&gt; { this.supportsPassive = true return true } }) window.addEventListener(\"testPassive\", null, opts) window.removeEventListener(\"testPassive\", null, opts) } catch (e) { console.error(e) } } destroy() { this.holderBig.removeEventListener(\"scroll\", this.scroll) this.holderSmall.removeEventListener(\"scroll\", this.scroll) this.el.removeChild(this.holderBig) this.el.removeChild(this.holderSmall) } } × Search results Close "},"class_Event.js.html":{"id":"class_Event.js.html","title":"Source: class/Event.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: class/Event.js /** * @description 自定义事件分发。 * @example * // 使用 * let event = new Event() * event.on(\"myevent\", callback) * // 一次性事件 * event.on(\"myevent\", callback, true) * event.off(\"myevent\", callback) */ class Event { // on 监听的事件 onEvents = {} index = -1 count = 0 // once 表示注册的事件只执行一次便自动移除 on (name, callback, once = false) { this.onEvents[name] = this.onEvents[name] || [] this.onEvents[name].push({ name: name, callback: callback, once: once }) } // 移除事件 off (name, callback) { if (!this.onEvents[name] || !this.onEvents[name].length) { return } this.onEvents[name] = this.onEvents[name].filter((event, index) =&gt; { let flag = true // 在emit的回调中，可能会off事件 if (event.callback === callback) { flag = false if (index &lt;= this.index &amp;&amp; name === this.name) { this.count++ } } return flag }) } emit (name) { if (!this.onEvents[name] || !this.onEvents[name].length) { return } const params = [...arguments].slice(1) this.name = name for (let i = 0; i &lt; this.onEvents[name].length; i++) { const event = this.onEvents[name][i] // 需要先判断是否为一次性事件，先移除 // 以防在事件回调中继续触发当前事件时即使是一次性事件也会执行多次 if (event.once) { this.onEvents[name].splice(i, 1) i-- } // 记录此时的index this.index = i event.callback(...params) // 如果回调中off事件，需要记录off的小于等于这个index的个数 i -= this.count this.count = 0 } this.count = 0 this.index = -1 } } × Search results Close "},"class_LoadImg.js.html":{"id":"class_LoadImg.js.html","title":"Source: class/LoadImg.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: class/LoadImg.js /** * @description 渐显加载图片。 * @example * // 使用 * let img = new LoadImg(document.querySelector('#img')) * img.setSrc('./a.jpg').then(callback) */ class LoadImg { constructor(el) { this.el = el el.addEventListener(\"load\", this.showImg) } setSrc(src) { return new Promise(resolve =&gt; { requestAnimationFrame(() =&gt; { Object.assign(this.el.style, { opacity: 0, visibility: \"hidden\" }) requestAnimationFrame(() =&gt; { this.el.src = src }) }) this.resolve = resolve }) } show = e =&gt; { const el = e.target setTimeout(() =&gt; { Object.assign(el.style, { opacity: 1, transition: \"opacity 0.5s ease\", visibility: \"visible\" }) el.addEventListener(\"transitionend\", () =&gt; { Object.assign(el.style, { transition: \"initial\" }) this.resolve &amp;&amp; this.resolve() this.resolve = null }) }, 300) } } × Search results Close "},"color-util.js.html":{"id":"color-util.js.html","title":"Source: color-util.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: color-util.js /** * 颜色相关函数。 * @module color */ /** * @description Hex颜色转Rgb * @example * HexToRgb('#fff333') * // rbg(255,243,51) * @param {String} str Hex 颜色(6位) * @return {String} Rgb 颜色 */ function HexToRgb (str) { const hexReg = /^#?[0-9A-Fa-f]{6}$/ if (!hexReg.test(str)) { return str } const color = str.replace('#', '') const hxs = color.match(/../g) for (let i = 0; i &lt; 3; i++) hxs[i] = parseInt(hxs[i], 16) return `rbg(${hxs.join(',')})` } /** * @description Rgb 转 Hex * @example * RgbToHex('rgb(255,243,51)') * // #fff333 * @param {String} rgb rgb 颜色 * @return {String} hex 颜色 */ function RgbToHex (rgb) { const reg = /\\d{1,3}/g const rgbAry = rgb.match(reg) if (rgbAry.length !== 3) { return rgb } const hexs = [ parseInt(rgbAry[0]).toString(16), parseInt(rgbAry[1]).toString(16), parseInt(rgbAry[2]).toString(16) ] for (let i = 0; i &lt; 3; i++) { if (hexs[i].length === 1) { hexs[i] = '0' + hexs[i] } } return '#' + hexs.join('') } /** * @description Rgb 转 Rgba * @example * toRgba('#fff333', 0.6) * // rgba(255, 243, 51, 0.6) * toRgba('rgb(233, 233, 5)', 0.6) * // rgba(233, 233, 5, 0.6) * @param {String} color 颜色：Rgb 或 Hex * @param {Number} opacity 透明度 * @return {String} Rgba 颜色 */ function toRgba (color, opacity) { if (typeof opacity !== 'number' || opacity &gt; 1 || opacity &lt; 0) { return color } const rgb = HexToRgb(color) const reg = /\\d{1,3}/g const rgbAry = rgb.match(reg) if (!rgbAry.length) { return } rgbAry.push(opacity) return `rgba(${rgbAry.join(', ')})` } /** * @description 颜色变深 * @example * darkenColor('rgb(40, 40, 40)', 0.2) * // rgb(32, 32, 32) * @param {String} color 颜色：Rgb, Hex, Rgba * @param {Number} level 变深程度：[0, 1] * @return {String} Rgb 颜色 */ function darkenColor (color, level) { if (typeof level !== 'number' || level &gt; 1 || level &lt; 0) { return color } const rgb = HexToRgb(color) const reg = /\\d{1,3}/g const rgbAry = rgb.match(reg) for (let i = 0; i &lt; 3; i++) { rgbAry[i] = Math.floor(rgbAry[i] * (1 - level)) } return `rgb(${rgbAry.join(', ')})` } /** * @description 颜色变浅 * @lightnessColor * darkenColor('rgb(40, 40, 40)', 0.2) * // rgb(83, 83, 83) * @param {String} color 颜色：Rgb, Hex, Rgba * @param {Number} level 变浅程度：[0, 1] * @return {String} Rgb 颜色 */ function lightnessColor (color, level) { if (typeof level !== 'number' || level &gt; 1 || level &lt; 0) { return color } const rgb = HexToRgb(color) const reg = /\\d{1,3}/g const rgbAry = rgb.match(reg).map(item =&gt; parseInt(item)) for (let i = 0; i &lt; 3; i++) { rgbAry[i] = Math.floor((255 - rgbAry[i]) * level + rgbAry[i]) } return `rgb(${rgbAry.join(', ')})` } × Search results Close "},"util.js.html":{"id":"util.js.html","title":"Source: util.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: util.js /* eslint-disable no-unused-vars */ /** * 通用函数。 * @module common */ /** * @description 函数柯里化。 * @example * function add(a, b) { * return a + b * } * var curriedAdd = curry(add) * var addFive = curriedAdd(5) * var result = [0, 1, 2, 3, 4, 5].map(addFive) * // [5, 6, 7, 8, 9, 10] * @param {function} fn 需要柯里化的函数，函数“无默认值的参数”个数不为0。 * @return {function} 柯里化后的函数。 */ function curry (fn) { // fn的无默认值参数的个数 if (fn.length === 0) { return fn } function _curried (depth, args) { return function (newArgument) { // 需要传入fn需要的参数个数，才会返回值 if (depth - 1 === 0) { return fn(...args, newArgument) } return _curried(depth - 1, [...args, newArgument]) } } return _curried(fn.length, []) } /** * @description 最大重复数数量 * @example * countMaxDuplicateNumber([1,2,2,5,5,5]) * // 3 * @param {Array} array 数字数组 * @return {Number} 数量 */ function countMaxDuplicateNumber (array) { if (!array.length) { return 0 } const sortedAry = array.sort((a, b) =&gt; { return a - b }) let count = 1 let max = 1 for (let i = 1; i &lt; sortedAry.length; i++) { if (sortedAry[i - 1] === sortedAry[i]) { max++ } else { if (max &gt; count) { count = max } max = 1 } } return count } /** * @description requestAnimationFrame 节流函数。 * @param {Function} fn 数字数组。 * @return {Function} 节流函数。 */ function throttle (fn) { let curTick = false const that = this const params = [...arguments] params.shift() return function () { const curParams = [...arguments] if (!curTick) { curTick = true requestAnimationFrame(() =&gt; { fn.apply(that, [...curParams, params]) curTick = false }) } } } × Search results Close "},"date-util.js.html":{"id":"date-util.js.html","title":"Source: date-util.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: date-util.js /** * 日期相关函数。 * @module date */ /** * @description 时间格式化 * @example * dateFormatter(new Date(2015, 1, 10, 14, 25, 33), 'yyyy-MM-dd hh:mm:ss') * dateFormatter(new Date(2015, 1, 10, 14, 25, 33), 'yyyy-M-d hh:mm:ss') * dateFormatter('2015-2-10 14:25:33', 'yyyy-M-d h:m:ss') * dateFormatter('2015-2-10 14:25:33', 'yyyy年第qq季度') * // 2015-02-10 14:25:33 * // 2015-2-10 14:25:33 * // 2015-2-10 14:25:33 * // 2015年第01季度 * @param {String|Date} date 需要格式化的时间。 * @param {String} format 格式模板。 * @return {String} 格式化后的时间字符。 */ function dateFormatter (date, format) { // 时间格式化辅助函数 date:毫秒数 format:'yyyy-MM-dd hh:mm:ss' if (!date || date === '') { return '' } let cdate = date if (typeof cdate === 'string') { const mts = cdate.match(/(\\/Date\\((\\d+)\\)\\/)/) if (mts &amp;&amp; mts.length &gt;= 3) { cdate = parseInt(mts[2]) } } cdate = new Date(cdate) if (!cdate || cdate.toUTCString() === 'Invalid Date') { return '' } const map = { M: cdate.getMonth() + 1, // 月份 d: cdate.getDate(), // 日 h: cdate.getHours(), // 小时 m: cdate.getMinutes(), // 分 s: cdate.getSeconds(), // 秒 q: Math.floor((cdate.getMonth() + 3) / 3), // 季度 S: cdate.getMilliseconds() // 毫秒 } const formatTime = format.replace(/([yMdhmsqS])+/g, function (all, t) { let v = map[t] if (v !== undefined) { if (all.length &gt; 1) { v = '0' + v v = v.substr(v.length - 2) } return v } if (t === 'y') { return (cdate.getFullYear() + '').substr(4 - all.length) } return all }) return formatTime } /** * 判断是否是合法日期对象 * @param {Date} date 日期对象 * @returns {Boolean} true or false */ function isValidDate (date) { if (date instanceof Date === false) { return false } return date.toString() !== 'Invalid Date' } /** * 判断是否是润年 * @param {Number} year 年份 * @returns {Boolean} true or false */ function isLeapYear (year) { return (year % 4 === 0 &amp;&amp; year % 100 !== 0) || year % 400 === 0 } /** * @ignore * 判断是否是大月 * @param {Number} month 月份 * @returns {Boolean} true or false */ function isBigMonth (month) { const bigMonths = [0, 2, 4, 6, 7, 9, 11] return bigMonths.includes(month) } /** * 获取月份天数 * @param {Date} date 日期 * @returns {Number} 天数 */ function getMonthDays (date) { const month = date.getMonth() const year = date.getFullYear() if (isBigMonth(month)) { return 31 } if (month === 1) { if (isLeapYear(year)) { return 29 } return 28 } return 30 } /** * 转换成日期对象 * @param {String} time 时间字符串 * @returns {Date} 日期对象 */ function toDate (time) { let date = time if (typeof date === 'string') { date = new Date(date) } return date } /** * 判断日期相等 * @param {Date|String} stime 日期1 * @param {Date|String} ttime 日期2 * @returns {Boolean} true or false */ function isEqualDate (stime, ttime) { const sdate = toDate(stime) const tdate = toDate(ttime) if (!isValidDate(sdate) || !isValidDate(tdate)) { return false } return sdate.getTime() === tdate.getTime() } /** * @ignore * 获取完全的日期，年月日时分秒毫秒 * @param {Date|String} date 日期 * @returns {Object} 包含年月日时分秒毫秒 */ function getFullDate (date) { return { year: date.getFullYear(), month: date.getMonth(), date: date.getDate(), day: date.getDay(), hours: date.getHours(), minutes: date.getMinutes(), seconds: date.getSeconds(), milliSeconds: date.getMilliseconds() } } /** * 判断日期模糊相等 * @example * isEqualDateFuzzy('2015-3-2','2015-3-2 12:56','date') * // true * @param {Date|String} stime 日期1 * @param {Date|String} ttime 日期2 * @param {String} tag 相等界限，取值范围：&lt;br&gt; * year, month, date, hours, minutes, seconds, milliSeconds,&lt;br&gt; * day — 星期。 * @returns {Boolean} true or false */ function isEqualDateFuzzy (stime, ttime, tag) { const sdate = toDate(stime) const tdate = toDate(ttime) if (!isValidDate(sdate) || !isValidDate(tdate)) { return false } const allTags = [ 'year', 'month', 'date', 'hours', 'minutes', 'seconds', 'milliSeconds' ] const index = allTags.indexOf(tag) if (index === -1) { return isEqualDate(sdate, tdate) } // 获取年月日星期时分秒毫秒组成的对象 const fullsdate = getFullDate(sdate) const fulltdate = getFullDate(tdate) // 星期相等 if (tag === 'day') { return fullsdate.day === fulltdate.day } for (let i = 0; i &lt; index + 1; i++) { if (fullsdate[allTags[i]] !== fulltdate[allTags[i]]) { return false } } return true } /** * 根据日、周、月、年获取指定日期所在时间段。 * @example * getPeriod('2015-3-2','month') * // new Date('2015-3-1') * // new Date('2015-3-31') * @param {Date|String} date 日期 * @param {Date|String} unit 单位：day, week, month, year * @returns {Array} 一个数组，包括开始日期和结束日期。 */ function getPeriod (date = new Date(), unit) { const cdate = toDate(date) if (!isValidDate(cdate)) { return false } const year = cdate.getFullYear() const month = cdate.getMonth() const d = cdate.getDate() const day = cdate.getDay() || 7 const oneDay = 24 * 60 * 60 * 1000 const today = new Date(year, month, d) if (unit === 'day') { return [today, new Date(today.getTime() + oneDay)] } if (unit === 'week') { return [ new Date(today.getTime() - (day - 1) * oneDay), new Date(today.getTime() + (8 - day) * oneDay) ] } if (unit === 'month') { const startDate = 1 let nextMonth = '' if (month === 11) { nextMonth = new Date(year + 1, 0, 1) } else { nextMonth = new Date(year, month + 1, 1) } return [new Date(year, month, startDate), nextMonth] } if (unit === 'year') { return [new Date(year, 0, 1), new Date(year + 1, 0, 1)] } } /** * 最大的连续天数数量。 * @example * countMaxConsecutiveDate([ * new Date(2015, 1, 1), * new Date(2015, 1, 4), * new Date(2015, 1, 5) * ]) * // 2 * @param {Date} dates 日期数组 * @returns {Number} 数量 */ function countMaxConsecutiveDate (dates) { const cdates = dates.map(date =&gt; { const cdate = new Date(date) return new Date( cdate.getFullYear(), cdate.getMonth(), cdate.getDate() ).getTime() }) const sortedDates = cdates.sort((a, b) =&gt; { return a - b }) let count = 1 let max = 1 for (let i = 1; i &lt; sortedDates.length; i++) { if (sortedDates[i] - sortedDates[i - 1] === 24 * 60 * 60 * 1000) { max++ } else { if (max &gt; count) { count = max } max = 1 } } return count } × Search results Close "},"html-util.js.html":{"id":"html-util.js.html","title":"Source: html-util.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: html-util.js /** * 页面相关函数。 * @module html */ /** * @description 判断页面是否可以滚动 * @return {Boolean} trye or false */ function checkPageCanScroll () { const viewHeight = document.documentElement.clientHeight const viewWidth = document.documentElement.clientWidth const bodyStyle = window.getComputedStyle(document.body) const htmlStyle = window.getComputedStyle(document.documentElement) return ( bodyStyle.overflow !== 'hidden' &amp;&amp; htmlStyle.overflow !== 'hidden' &amp;&amp; (document.documentElement.scrollHeight &gt; viewHeight || document.documentElement.scrollWidth &gt; viewWidth) ) } /** * @description 判断节点内部是否可以滚动 * @param {HTMLElement} el html 节点 * @return {Boolean} trye or false */ function checkNodeCanScroll (el) { const elStyle = window.getComputedStyle(el) return ( (elStyle.overflow === 'scroll' || elStyle.overflow === 'auto') &amp;&amp; (el.scrollHeight &gt; el.clientHeight || el.scrollWidth &gt; el.clientWidth) ) } /** * @description 截断文字添加省略号，单位长度为一个汉字长度。 * @example * cutText('xxxyyy', 2) * // xxxy * @param {String} text 字符 * @param {Number} length 长度，以一个汉字长度为单位 * @return {String} 截断后的字符 */ function cutText (text, length) { let realLength = 0 let charCode = -1 let index = 0 for (let i = 0; i &lt; text.length; i++) { charCode = text.charCodeAt(i) if (charCode &gt;= 0 &amp;&amp; charCode &lt;= 128) { // 占一个宽度的字符 realLength += 1 } else { // 占两个宽度的字符，例如：汉字 realLength += 2 } if (realLength &gt; length * 2) { index = i break } } if (index &gt; length - 1) { return text.slice(0, index) + '...' } return text } /** * @description 获取 canvas 存储的像素比 和 屏幕像素比比值 。&lt;br&gt; * 即如果比值为x，那么canvas的真正大小（width属性）应该是：css像素*x。 * @return {Number} 比值。 */ function getPixelRatio () { const canvas = document.createElement('canvas') const context = canvas.getContext('2d') const backingStoreRatio = context.webkitBackingStorePixelRatio || context.mozBackingStorePixelRatio || context.msBackingStorePixelRatio || context.oBackingStorePixelRatio || context.backingStorePixelRatio || 1 const devicePixelRatio = window.devicePixelRatio || 1 return devicePixelRatio / backingStoreRatio } /** * @description 获取 canvas dataURL（转化为图片）。&lt;br&gt; * 获取的图片分辨率适应当前设备的设备像素比，即在 Retina 屏幕下获取的图片分辨率更高。 * @param {HTMLElement} canvas - canvas 节点。 * @return {String} dataURL。 */ function canvasToImg (canvas) { const scale = getPixelRatio() const style = window.getComputedStyle(canvas) canvas.width = scale * parseFloat(style.width) canvas.height = scale * parseFloat(style.height) return canvas.toDataURL() } /** * @ignore * @description dataURL 转换为 blob 对象。 * @param {String} dataURL - dataURL。 * @param {Blob} Blob 对象。 */ function dataURLToBlob (dataURL) { // atob：解码base64，并提取data部分 const data = atob(dataURL.split(',')[1]) const len = data.length const arr = new Uint8Array(len) for (let i = 0; i &lt; len; i++) { arr[i] = data.charCodeAt(i) } return new Blob([arr]) } /** * @description 下载图片，如果是网络图片（http开头），需要同域名。&lt;br&gt; * 同时依赖于a标签的download兼容性，移动端兼容性差。 * @param {String} src - 图片链接，可以是blob url, dataURL, 网络图片（http开头）。 * @param {Number} imgName - 图片名字。 * @param {Number} useblob - 转换为blob url，只有dataURL可以转换。 */ function downloadImg (src, imgName, useblob = false) { let url = '' if (src.startsWith('blob:')) { // 本身是 blob url url = src } else { if (useblob) { const blob = dataURLToBlob(src) if (window.navigator.msSaveBlob) { try { window.navigator.msSaveBlob(blob, imgName) } catch (e) { console.error(e) } return } url = URL.createObjectURL(blob) } else { url = src } } const a = document.createElement('a') a.download = imgName a.href = url a.click() a.remove() // 释放创建的url对象 URL.revokeObjectURL(url) } × Search results Close "},"class_RandomSeed.js.html":{"id":"class_RandomSeed.js.html","title":"Source: class/RandomSeed.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: class/RandomSeed.js /** * @description 带缓存的随机数种子。 * @example * const seed = new RandomSeed(5, 10, [6]) * seed.do() * // 5 or 7 or 8 or 9 or 10 */ class RandomSeed { /** * @param {Number} lower - 下限（包含）。 * @param {Number} upper - 上限（包含）。 * @param {Array} initCache - 初始缓存数组。 * @param {Boolean} loop - 如果是，当缓存满时，清空缓存。默认 true。 */ constructor (lower, upper, initCache, loop = true) { if (upper &lt; lower) { throw new Error('params error') } this.lower = lower this.upper = upper this.loop = loop // 在随机范围内 数的个数 this.length = this.upper - this.lower + 1 this.setCache(initCache || []) } setCache (cache) { this.initCache = cache this.cache = cache.concat() // 缓存中界限外的数个数 this.outBoundsNum = this.initCache.reduce((total, val) =&gt; { if (val &lt; this.lower || val &gt; this.upper) { return total + 1 } return total }, 0) // cache 能放入的元素个数是 // cache 的长度加 cache中 超出界限的数的个数 this.cacheLimitLength = this.length + this.outBoundsNum } do () { if (!this.loop &amp;&amp; this.cache.length === this.cacheLimitLength) { return } if (this.upper - this.lower === 0) { return this.lower } const random = Math.floor(Math.random() * this.length + this.lower) if (this.cache.length === this.cacheLimitLength) { const lastValue = this.cache[this.cache.length - 1] if (random === lastValue) { return this.do() } this.cache = this.initCache.concat() || [] } if (this.cache.some(number =&gt; number === random)) { return this.do() } this.cache.push(random) return random } } const seed = new RandomSeed(5, 10, [6]) for (let index = 0; index &lt; 10; index++) { console.log(seed.do()) } // 5 or 7 or 8 or 9 or 10 × Search results Close "},"class_Slide.js.html":{"id":"class_Slide.js.html","title":"Source: class/Slide.js","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Source: class/Slide.js /** * 封装鼠标触摸事件。 * @example * const el = document.querySelector('#container') * new Slide(el, 200, 200) * el.addEventListener('slidemove', (e) =&gt; { * console.log(e.detail) * // { * // // 滑动开始的点 * // startx: , * // starty: , * // // 滑动过程的点 * // endx: , * // endy: , * // // 滑动过程中与上一个点的距离 * // dx: , * // dy: , * // // 滑动过程中与开始点的距离 * // offsetx: , * // offsety: * // } * }) */ class Slide { // dom节点 el = null // 手指移动过程中上一个坐标 prePoint = { x: 0, y: 0 } // 自定义用户数据 customData = { // 滑动开始的点 startx: 0, starty: 0, // 滑动过程的点 endx: 0, endy: 0, // 滑动过程中与上一个点的距离 dx: 0, dy: 0, // 滑动过程中与开始点的距离 offsetx: 0, offsety: 0 } /** * @param {HTMLElement} el - html 节点。 * @param {Number} maxSlideDx - x 方向最大移动距离。 * @param {Number} maxSlideDy - y 方向最大移动距离。 */ constructor (el, maxSlideDx, maxSlideDy) { this.el = el // 单次的最大横向滑动距离 this.maxSlideDx = maxSlideDx this.maxSlideDy = maxSlideDy this._init() } _init () { // 注册滑动开始、过程、结束事件 this.slidestart = new CustomEvent('slidestart', { detail: this.customData, bubbles: true, cancelable: true }) this.slidemove = new CustomEvent('slidemove', { detail: this.customData, bubbles: true, cancelable: true }) this.slideend = new CustomEvent('slideend', { detail: this.customData, bubbles: true, cancelable: true }) // 监听原生触摸事件 this.el.addEventListener('touchstart', this._start) this.el.addEventListener('touchmove', this._move) this.el.addEventListener('touchend', this._end) window.addEventListener('mousedown', this._start) window.addEventListener('mousemove', this._move) window.addEventListener('mouseup', this._end) } checkNode (node) { if (!node) { return false } if (node === this.el) { return true } return this.checkNode(node.parentNode) } _start = (e) =&gt; { let startx = 0 let starty = 0 if (e.type === 'mousedown') { if (e.button !== 0) { return } if (this.checkNode(e.target)) { this.canSlide = true } else { this.canSlide = false return } e.preventDefault() startx = e.pageX starty = e.pageY } else { startx = e.targetTouches[0].pageX starty = e.targetTouches[0].pageY } // 初始化data Object.assign(this.customData, { startx, starty, endx: startx, endy: starty, dx: 0, dy: 0, offsetx: 0, offsety: 0 }) this.prePoint = { x: startx, y: starty } this.el.dispatchEvent(this.slidestart) } _move = (e) =&gt; { let endx = 0 let endy = 0 if (e.type === 'mousemove') { if (!this.canSlide) { return } endx = e.pageX endy = e.pageY } else { endx = e.targetTouches[0].pageX endy = e.targetTouches[0].pageY } // 相较于上一次touchmove点的距离 let dx = endx - this.prePoint.x let dy = endy - this.prePoint.y let offsetx = 0 let offsety = 0 // 单次滑动过程不能超过设定maxSlideDx值 if (this.customData.offsetx + dx &gt; this.maxSlideDx) { dx = this.maxSlideDx - this.customData.offsetx offsetx = this.maxSlideDx } else if (this.customData.offsetx + dx &lt; -this.maxSlideDx) { dx = -this.maxSlideDx - this.customData.offsetx offsetx = -this.maxSlideDx } else { offsetx = endx - this.customData.startx } // 单次滑动过程不能超过设定maxSlideDy值 if (this.customData.offsety + dy &gt; this.maxSlideDy) { dy = this.maxSlideDy - this.customData.offsety offsety = this.maxSlideDy } else if (this.customData.offsety + dy &lt; -this.maxSlideDy) { dy = -this.maxSlideDy - this.customData.offsety offsety = -this.maxSlideDy } else { offsety = endy - this.customData.starty } Object.assign(this.customData, { endx, endy, dx, dy, offsetx, offsety }) this.prePoint = { x: endx, y: endy } this.el.dispatchEvent(this.slidemove) } _end = (e) =&gt; { let endx = 0 let endy = 0 if (e.type === 'mouseup') { if (!this.canSlide) { return } endx = e.pageX endy = e.pageY this.canSlide = false } else { endx = e.changedTouches[0].pageX endy = e.changedTouches[0].pageY } Object.assign(this.customData, { endx, endy }) this.el.dispatchEvent(this.slideend) } setMaxSlideDx (ds) { this.maxSlideDx = ds } setMaxSlideDy (ds) { this.maxSlideDy = ds } // 销毁自定义事件 destroy () { this.el.removeEventListener('touchstart', this._start) this.el.removeEventListener('touchmove', this._move) this.el.removeEventListener('touchend', this._end) } } × Search results Close "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Modules Classes DomResize Event LoadImg RandomSeed Slide × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Classes Classes DomResize Event LoadImg RandomSeed Slide × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide 测试 × Search results Close "},"DomResize.html":{"id":"DomResize.html","title":"Class: DomResize","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Class: DomResize DomResize new DomResize() 节点大小监测。 Source: class/DomResize.js, line 18 Example // 使用 let event = new DomResize(document.querySelector('#contianer')) event.on('dom-resize', callback) × Search results Close "},"Event.html":{"id":"Event.html","title":"Class: Event","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Class: Event Event new Event() 自定义事件分发。 Source: class/Event.js, line 13 Example // 使用 let event = new Event() event.on(\"myevent\", callback) // 一次性事件 event.on(\"myevent\", callback, true) event.off(\"myevent\", callback) × Search results Close "},"LoadImg.html":{"id":"LoadImg.html","title":"Class: LoadImg","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Class: LoadImg LoadImg new LoadImg() 渐显加载图片。 Source: class/LoadImg.js, line 10 Example // 使用 let img = new LoadImg(document.querySelector('#img')) img.setSrc('./a.jpg').then(callback) × Search results Close "},"module-color.html":{"id":"module-color.html","title":"Module: color","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Module: color 颜色相关函数。 Source: color-util.js, line 1 Methods &lt;inner&gt; darkenColor(color, level) → {String} 颜色变深 Parameters: Name Type Description color String 颜色：Rgb, Hex, Rgba level Number 变深程度：[0, 1] Source: color-util.js, line 98 Returns: Rgb 颜色 Type String Example darkenColor('rgb(40, 40, 40)', 0.2) // rgb(32, 32, 32) &lt;inner&gt; HexToRgb(str) → {String} Hex颜色转Rgb Parameters: Name Type Description str String Hex 颜色(6位) Source: color-util.js, line 15 Returns: Rgb 颜色 Type String Example HexToRgb('#fff333') // rbg(255,243,51) &lt;inner&gt; lightnessColor(color, level) → {String} 颜色变浅 Parameters: Name Type Description color String 颜色：Rgb, Hex, Rgba level Number 变浅程度：[0, 1] Source: color-util.js, line 123 Returns: Rgb 颜色 Type String &lt;inner&gt; RgbToHex(rgb) → {String} Rgb 转 Hex Parameters: Name Type Description rgb String rgb 颜色 Source: color-util.js, line 38 Returns: hex 颜色 Type String Example RgbToHex('rgb(255,243,51)') // #fff333 &lt;inner&gt; toRgba(color, opacity) → {String} Rgb 转 Rgba Parameters: Name Type Description color String 颜色：Rgb 或 Hex opacity Number 透明度 Source: color-util.js, line 72 Returns: Rgba 颜色 Type String Example toRgba('#fff333', 0.6) // rgba(255, 243, 51, 0.6) toRgba('rgb(233, 233, 5)', 0.6) // rgba(233, 233, 5, 0.6) × Search results Close "},"module-common.html":{"id":"module-common.html","title":"Module: common","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Module: common 通用函数。 Source: util.js, line 2 Methods &lt;inner&gt; countMaxDuplicateNumber(array) → {Number} 最大重复数数量 Parameters: Name Type Description array Array 数字数组 Source: util.js, line 49 Returns: 数量 Type Number Example countMaxDuplicateNumber([1,2,2,5,5,5]) // 3 &lt;inner&gt; curry(fn) → {function} 函数柯里化。 Parameters: Name Type Description fn function 需要柯里化的函数，函数“无默认值的参数”个数不为0。 Source: util.js, line 21 Returns: 柯里化后的函数。 Type function Example function add(a, b) { return a + b } var curriedAdd = curry(add) var addFive = curriedAdd(5) var result = [0, 1, 2, 3, 4, 5].map(addFive) // [5, 6, 7, 8, 9, 10] &lt;inner&gt; throttle(fn) → {function} requestAnimationFrame 节流函数。 Parameters: Name Type Description fn function 数字数组。 Source: util.js, line 78 Returns: 节流函数。 Type function × Search results Close "},"module-date.html":{"id":"module-date.html","title":"Module: date","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Module: date 日期相关函数。 Source: date-util.js, line 1 Methods &lt;inner&gt; countMaxConsecutiveDate(dates) → {Number} 最大的连续天数数量。 Parameters: Name Type Description dates Date 日期数组 Source: date-util.js, line 297 Returns: 数量 Type Number Example countMaxConsecutiveDate([ new Date(2015, 1, 1), new Date(2015, 1, 4), new Date(2015, 1, 5) ]) // 2 &lt;inner&gt; dateFormatter(date, format) → {String} 时间格式化 Parameters: Name Type Description date String | Date 需要格式化的时间。 format String 格式模板。 Source: date-util.js, line 22 Returns: 格式化后的时间字符。 Type String Example dateFormatter(new Date(2015, 1, 10, 14, 25, 33), 'yyyy-MM-dd hh:mm:ss') dateFormatter(new Date(2015, 1, 10, 14, 25, 33), 'yyyy-M-d hh:mm:ss') dateFormatter('2015-2-10 14:25:33', 'yyyy-M-d h:m:ss') dateFormatter('2015-2-10 14:25:33', 'yyyy年第qq季度') // 2015-02-10 14:25:33 // 2015-2-10 14:25:33 // 2015-2-10 14:25:33 // 2015年第01季度 &lt;inner&gt; getMonthDays(date) → {Number} 获取月份天数 Parameters: Name Type Description date Date 日期 Source: date-util.js, line 114 Returns: 天数 Type Number &lt;inner&gt; getPeriod(date, unit) → {Array} 根据日、周、月、年获取指定日期所在时间段。 Parameters: Name Type Description date Date | String 日期 unit Date | String 单位：day, week, month, year Source: date-util.js, line 245 Returns: 一个数组，包括开始日期和结束日期。 Type Array Example getPeriod('2015-3-2','month') // new Date('2015-3-1') // new Date('2015-3-31') &lt;inner&gt; isEqualDate(stime, ttime) → {Boolean} 判断日期相等 Parameters: Name Type Description stime Date | String 日期1 ttime Date | String 日期2 Source: date-util.js, line 152 Returns: true or false Type Boolean &lt;inner&gt; isEqualDateFuzzy(stime, ttime, tag) → {Boolean} 判断日期模糊相等 Parameters: Name Type Description stime Date | String 日期1 ttime Date | String 日期2 tag String 相等界限，取值范围： year, month, date, hours, minutes, seconds, milliSeconds, day — 星期。 Source: date-util.js, line 194 Returns: true or false Type Boolean Example isEqualDateFuzzy('2015-3-2','2015-3-2 12:56','date') // true &lt;inner&gt; isLeapYear(year) → {Boolean} 判断是否是润年 Parameters: Name Type Description year Number 年份 Source: date-util.js, line 91 Returns: true or false Type Boolean &lt;inner&gt; isValidDate(date) → {Boolean} 判断是否是合法日期对象 Parameters: Name Type Description date Date 日期对象 Source: date-util.js, line 78 Returns: true or false Type Boolean &lt;inner&gt; toDate(time) → {Date} 转换成日期对象 Parameters: Name Type Description time String 时间字符串 Source: date-util.js, line 136 Returns: 日期对象 Type Date × Search results Close "},"module-html.html":{"id":"module-html.html","title":"Module: html","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Module: html 页面相关函数。 Source: html-util.js, line 1 Methods &lt;inner&gt; canvasToImg(canvas) → {String} 获取 canvas dataURL（转化为图片）。 获取的图片分辨率适应当前设备的设备像素比，即在 Retina 屏幕下获取的图片分辨率更高。 Parameters: Name Type Description canvas HTMLElement canvas 节点。 Source: html-util.js, line 103 Returns: dataURL。 Type String &lt;inner&gt; checkNodeCanScroll(el) → {Boolean} 判断节点内部是否可以滚动 Parameters: Name Type Description el HTMLElement html 节点 Source: html-util.js, line 31 Returns: trye or false Type Boolean &lt;inner&gt; checkPageCanScroll() → {Boolean} 判断页面是否可以滚动 Source: html-util.js, line 11 Returns: trye or false Type Boolean &lt;inner&gt; cutText(text, length) → {String} 截断文字添加省略号，单位长度为一个汉字长度。 Parameters: Name Type Description text String 字符 length Number 长度，以一个汉字长度为单位 Source: html-util.js, line 50 Returns: 截断后的字符 Type String Example cutText('xxxyyy', 2) // xxxy &lt;inner&gt; downloadImg(src, imgName, useblob) 下载图片，如果是网络图片（http开头），需要同域名。 同时依赖于a标签的download兼容性，移动端兼容性差。 Parameters: Name Type Default Description src String 图片链接，可以是blob url, dataURL, 网络图片（http开头）。 imgName Number 图片名字。 useblob Number false 转换为blob url，只有dataURL可以转换。 Source: html-util.js, line 139 &lt;inner&gt; getPixelRatio() → {Number} 获取 canvas 存储的像素比 和 屏幕像素比比值 。 即如果比值为x，那么canvas的真正大小（width属性）应该是：css像素*x。 Source: html-util.js, line 81 Returns: 比值。 Type Number × Search results Close "},"RandomSeed.html":{"id":"RandomSeed.html","title":"Class: RandomSeed","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Class: RandomSeed RandomSeed new RandomSeed(lower, upper, initCache, loop) 带缓存的随机数种子。 Parameters: Name Type Default Description lower Number 下限（包含）。 upper Number 上限（包含）。 initCache Array 初始缓存数组。 loop Boolean true 如果是，当缓存满时，清空缓存。默认 true。 Source: class/RandomSeed.js, line 17 Example const seed = new RandomSeed(5, 10, [6]) seed.do() // 5 or 7 or 8 or 9 or 10 × Search results Close "},"Slide.html":{"id":"Slide.html","title":"Class: Slide","body":" Common Modules Modules colorcommondatehtml Classes DomResizeEventLoadImgRandomSeedSlide Class: Slide Slide 封装鼠标触摸事件。 new Slide(el, maxSlideDx, maxSlideDy) Parameters: Name Type Description el HTMLElement html 节点。 maxSlideDx Number x 方向最大移动距离。 maxSlideDy Number y 方向最大移动距离。 Source: class/Slide.js, line 55 Example const el = document.querySelector('#container') new Slide(el, 200, 200) el.addEventListener('slidemove', (e) =&gt; { console.log(e.detail) // { // // 滑动开始的点 // startx: , // starty: , // // 滑动过程的点 // endx: , // endy: , // // 滑动过程中与上一个点的距离 // dx: , // dy: , // // 滑动过程中与开始点的距离 // offsetx: , // offsety: // } }) × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
